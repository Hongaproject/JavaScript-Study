// 동기 비동기
// 자바스크립트는 싱글스레드로 동작하는 프로그래밍 언어이다.
// 싱글스레드는 콜 스택이 한 개라는 것을 뜻하며 이 뜻은 한 가지 일만 처리 가능하다라고 해석을 할 수 있다. -> 동기식

// 사용자가 데이터를 서버에 요청을 하면 서버는 데이터 요청에 따라 응답을 사용자에게 줘야하기 때문에 그 시간동안 다른 행동을 하지 못합니다. -> 동기식
// 사용자가 데이터를 서버에 요청을 해도 다른 행동을 할 수 있고 다른 데이터 내용을 서버에 요청을 해도 상관 없다. -> 비동기식

// 동기식으로 작동이 되는데 왜 비동기식으로 작동이 되나요? 

// 비동기로 작동되는것은 자바스크립트 때매가 아닌 브라우저의 도움을 받아서 비동기로 동작을 하게 됩니다.
// 동시성을 가능한 이유는 이벤트 루프덕인데 다음 글에 이벤트 루프 글을 작성하겠습니다.

// 이벤트루프
// 콜스택에 현재 실행 중인 실행 컨텍스트가 있는지, 태스크 큐에 대기중인 함수(콜백 함수, 이벤트 핸들러)가 있는지 반복해서 확인한다.
// 콜스택이 비어있고 태스크 큐에 대기중인 함수가 있다면 이벤트 루프는 순차적으로 태스크 큐에 대기 중인 함수를 콜스택으로 이동 시킨다. 그 후 콜스택으로 이동한 함수는 실행이 됩니다.

// 자바스크립트 엔진
// Memory Heap과 Call Stack으로 구성이 되어있음
// 자바스크립트는 싱글 스레드로 동작하는 프로그래밍 Call Stack이 한 개를 뜻합니다.
// Memory Heap : 메모리 할당이 일어나는 곳
// Call Stack : 후입선출로 동작한다. 코드가 실행될 때 호출 스택이 쌓이는 곳입니다.

// Web APIs
// 자바스크립트 자체가 비동기 동작을 지원하는 것이 아니고 브라우저 도움을 받음.
// Call Stack에서 실행된 비동기 함수는 Web API를 호출하게 됩니다.
// Web API는 콜백함수를 태스크 큐에 넣습니다. 

// Callback Queue
// 비동기적으로 실행된 콜백함수를 저장하는 자료구조, FIFO 선입선출


// 이벤트루프 예시
console.log("1");
setTimeout(function name() {
    console.log("2");  
}, 0);
console.log("3");  

console.log("1")이 Call Stack에 추가된다. 그 이후 실행되어 콘솔에 값이 출력된 후, Call Stack에서 제거된다.

setTimeout이 Call Stack에 추가됩니다.

setTimeout이 실행이 되고 브라우저에서 제공하는 Web API에 있는 Timeout을 호출하고 Call Stack에서 제거 됩니다.

console.log("3")이 Call Stack에 추가된다. 그 이후 실행되어 콘솔에 값이 출력된 후, Call Stack에서 제거된다.

setTimeout함수의 0ms만큼의 시간이 지난 뒤 Callback으로 전달된 name함수가 Task Queue에 추가됩니다.

Event Loop는 Call Stack이 비어있는 것을 확인하고 Task Queue를 살펴보고 name 함수를 발견하여 Call Stack에 name함수를 추가해줍니다.

name함수가 실행 되고 내부의 console.log("2")가 Call Stack에 추가됩니다.

console.log("2")이 실행되어 콘솔에 값이 출력되고 Call Stack에서 제거되고, name함수도 제거됩니다.-

// 콜백함수
// 다른 함수에 매개 변수로 넘겨주는 것을 뜻함, 매개 변수로 함수 객체를 전달하고 호출 함수 내에 매개변수 함수를 실행
// 매개 변수를 통해 다른 함수의 내부로 전달되는 함수 -> 콜백함수
// 매개 변수를 통해 콜백 함수를 전달 받는 함수를 -> 고차함수

// 함수 funcA는 콜백 함수인 funcB를 외부에서 매개변수를 통해 전달받은 '고차 함수' 
function funcA(callback) {
  callback()
}

// 함수 funcB는 함수 funcA의 '콜백 함수' 
function funcB() {
  console.log('콜백 함수입니다.')
}

funcA(funcB);  // 콜백 함수입니다. 

// 위 코드에 제어권
제어권은 funcA한테있다 funcA가 실행이 되면서 funcB가 실행이 되기 때문에 제어권은 A가 가져가게된다.

// 인자값 사용 -> map
map은 콜백함수를 사용해서 새로운 값을 반환 받는다

const arr = [10,20,30]
arr.map((value, index) => {
  console.log(value, index);
  return value + 10;
})

// 비동기통신 setTimeout
console.log("1");
console.log("2");
console.log("3"); 을 실행하면 1 2 3 순으로 나타난다. 동기적이기 때문이다 동기적이면 성능면이나 사용자 경험에 영향을 줄 수 있기에 비동기 처리를 도입하게 되었다.

console.log("1");
setTimeout(() => {
  console.log("2");
}, 1000);
console.log("3"); 를 실행하면 1 3 2 순으로 나타난다. setTimeout은 비동기 처리로 사용되는 내장함수이다. 이 부분은 이벤트 루프에 관한 글을 보면 더 자세하게 이해할 수 있다.

// 콜백지옥 
// 매개변수로 넘겨지는 콜백함수가 반복되어 코드 들여쓰기 수준이 감당하기 힘들 정도로 깊어지는 현상
// 코드 가독성이 떨어지고, 코드 수정하기 어려워짐 이를 해결하기 위해 es6때 promise를 도입했다.


 
